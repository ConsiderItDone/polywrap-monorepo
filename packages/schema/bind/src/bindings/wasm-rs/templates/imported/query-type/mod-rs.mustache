{{#__commonImport}}
pub use super::super::common::{ {{type}} };
{{/__commonImport}}
{{^__commonImport}}
use polywrap_wasm_rs::{
    BigInt,
    Read,
    Write,
    JSON,
    subinvoke
};
pub mod serialization;
{{#methods.length}}
pub use serialization::{
    {{#methods}}
    deserialize_{{#toLower}}{{name}}{{/toLower}}_result,
    serialize_{{#toLower}}{{name}}{{/toLower}}_args,
    Input{{#toUpper}}{{name}}{{/toUpper}},
    {{/methods}}
};
{{/methods.length}}
{{#propertyDeps.length}}

{{#propertyDeps}}
use {{crate}}::{{#toUpper}}{{type}}{{/toUpper}};
{{/propertyDeps}}
{{/propertyDeps.length}}

#[derive(Clone, Debug)]
pub struct {{#toUpper}}{{type}}{{/toUpper}} {}

impl {{#toUpper}}{{type}}{{/toUpper}} {
    pub const URI: &'static str = "{{uri}}";

    pub fn new() -> {{#toUpper}}{{type}}{{/toUpper}} {
        {{#toUpper}}{{type}}{{/toUpper}} {}
    }

    {{#methods}}
    pub fn {{#toLower}}{{name}}{{/toLower}}(input: &Input{{#toUpper}}{{name}}{{/toUpper}}) -> {{#return}}{{#toWasm}}{{toGraphQLType}}{{/toWasm}}{{/return}} {
        let uri = {{#query}}{{#toUpper}}{{type}}{{/toUpper}}{{/query}}::URI;
        let args = serialize_{{#toLower}}{{name}}{{/toLower}}_args(input);
        let result = subinvoke::w3_subinvoke(
            uri.to_string(),
            "{{#toLower}}{{type}}{{/toLower}}".to_string(),
            "{{#toLower}}{{name}}{{/toLower}}".to_string(),
            args,
        ).unwrap();
        deserialize_{{#toLower}}{{name}}{{/toLower}}_result(result.as_slice())
    }
    {{^last}}

    {{/last}}
    {{/methods}}
}
{{/__commonImport}}